<?xml version="1.0" encoding="utf-8"?>
<Defs>

  <MapGeneratorDef Name="Undercave">
    <defName>Undercave</defName>
    <label>undercave</label>
    <isUnderground>true</isUnderground>
    <forceCaves>true</forceCaves>
    <ignoreAreaRevealedLetter>true</ignoreAreaRevealedLetter>
    <disableCallAid>true</disableCallAid>
    <customMapComponents>
      <li>UndercaveMapComponent</li>
    </customMapComponents>
    <pocketMapProperties>
      <biome>Undercave</biome>
      <temperature>15</temperature>
      <tileMutators>
        <li>UndergroundCave</li>
      </tileMutators>
    </pocketMapProperties>
    <genSteps>
      <li>ElevationFertility</li>
      <li>MutatorPostElevationFertility</li>
      <li>Underground_RocksFromGrid</li>
      <li>Terrain</li>
      <li>MutatorPostTerrain</li>
      <li>Underground_ScatterRuinsSimple</li>
      <li>MutatorCriticalStructures</li>
      <li>MutatorNonCriticalStructures</li>
      <li>Fleshbulbs</li>
      <li>RockChunks</li>
      <li>PlaceCaveExit</li>
      <li>Dreadmeld</li>
      <li>Fleshmass</li>
      <li>FleshSacks</li>
      <li>UndercaveInterest</li>
      <li>Plants</li>
      <li>MutatorFinal</li>
      <li>Fog</li>
    </genSteps>
  </MapGeneratorDef>

  <GenStepDef>
    <defName>Fleshmass</defName>
    <order>250</order>
    <genStep Class="GenStep_Fleshmass">
      <fleshFrequency>0.15</fleshFrequency>
      <fleshThreshold>0.2</fleshThreshold>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>FleshSacks</defName>
    <order>251</order>
    <genStep Class="GenStep_FleshSacks">
      <numFleshSacksFromPoints>
        <points>
          <li>(0, 3)</li>
          <li>(500, 5)</li>
          <li>(1000, 7)</li>
          <li>(5000, 9)</li>
        </points>
      </numFleshSacksFromPoints>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <order>550</order>
    <defName>Fleshbulbs</defName>
    <genStep Class="GenStep_ScatterGroup">
      <minSpacing>20</minSpacing>
      <count>5</count>
      <validators>
        <li Class="ScattererValidator_Buildable">
          <affordance>Light</affordance>
        </li>
        <li Class="ScattererValidator_TerrainDef">
          <terrainDef>Flesh</terrainDef>
        </li>
      </validators>
      <groups>
        <li>
          <things>
            <Fleshbulb>1</Fleshbulb>
          </things>
          <coveredCellsPer10Cells>0.5~1.5</coveredCellsPer10Cells>
          <clusterRectRadius>2~3</clusterRectRadius>
        </li>
      </groups>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>Dreadmeld</defName>
    <order>600</order>
    <genStep Class="GenStep_Dreadmeld" />
  </GenStepDef>

  <GenStepDef>
    <defName>UndercaveInterest</defName>
    <order>650</order>
    <genStep Class="GenStep_UndercaveInterest" />
  </GenStepDef>

  <BiomeDef ParentName="Biome_Underground">
    <defName>Undercave</defName>
    <label>undercave</label>
    <description>This cave is filled with the putrid stench of rotting flesh.</description>
    <baseWeatherCommonalities>
      <Undercave>1</Undercave>
    </baseWeatherCommonalities>
  </BiomeDef>

</Defs>