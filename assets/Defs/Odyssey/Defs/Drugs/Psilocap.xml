<?xml version="1.0" encoding="utf-8" ?>
<Defs>

  <ThingDef ParentName="DrugBase">
    <defName>Drug_Psilocap</defName>
    <label>psilocap</label>
    <description>The fruiting body of a hallucinogenic fungus. When eaten it produces vivid sensory experiences and lifts mood. There is a small chance to immediately induce a catatonic state, or creatively inspire the user. Psilocaps are not addictive, but can cause overdoses if eaten in large quantities.\n\nSome cultures use psilocaps for religious ceremonies, while many others have outlawed the mushrooms entirely.</description>
    <descriptionHyperlinks>
      <HediffDef>PsilocapHigh</HediffDef>
      <HediffDef>PsilocapTolerance</HediffDef>
    </descriptionHyperlinks>
    <tradeability>Sellable</tradeability>
    <socialPropernessMatters>true</socialPropernessMatters>
    <tickerType>Rare</tickerType>
    <graphicData>
      <texPath>Things/Item/Drug/Psilocap</texPath>
      <graphicClass>Graphic_Random</graphicClass>
    </graphicData>
    <statBases>
      <MarketValue>10</MarketValue>
      <Mass>0.1</Mass>
      <DeteriorationRate>4</DeteriorationRate>
      <Nutrition>0.1</Nutrition>
    </statBases>
    <techLevel>Neolithic</techLevel>
    <rotatable>false</rotatable>
    <ingestible>
      <baseIngestTicks>80</baseIngestTicks>
      <chairSearchRadius>4</chairSearchRadius>
      <preferability>DesperateOnly</preferability>
      <tasteThought></tasteThought>
      <foodType>VegetableOrFruit</foodType>
      <joyKind>Chemical</joyKind>
      <joy>0.7</joy>
      <nurseable>true</nurseable>
      <drugCategory>Social</drugCategory>
      <canAutoSelectAsFoodForCaravan>false</canAutoSelectAsFoodForCaravan>
      <outcomeDoers>
        <li Class="IngestionOutcomeDoer_GiveHediff">
          <hediffDef>PsilocapHigh</hediffDef>
          <severity>0.60</severity>
          <toleranceChemical>Psilocap</toleranceChemical>
        </li>
        <li Class="IngestionOutcomeDoer_GiveHediff">
          <hediffDef>PsilocapTolerance</hediffDef>
          <toleranceChemical>Psilocap</toleranceChemical>
          <severity>0.04</severity>
          <divideByBodySize>true</divideByBodySize>
          <multiplyByGeneToleranceFactors>true</multiplyByGeneToleranceFactors>
        </li>
        <li Class="IngestionOutcomeDoer_Psilocap">
          <chanceBreakdown>0.01</chanceBreakdown>
          <chanceInspiration>0.02</chanceInspiration>
        </li>
      </outcomeDoers>
    </ingestible>
    <comps>
      <li Class="CompProperties_Rottable">
        <daysToRotStart>30</daysToRotStart>
        <rotDestroys>true</rotDestroys>
      </li>
      <li Class="CompProperties_Drug">
        <chemical>Psilocap</chemical>
        <addictiveness>0</addictiveness>
        <minToleranceToAddict>1</minToleranceToAddict>
        <existingAddictionSeverityOffset>0</existingAddictionSeverityOffset>
        <needLevelOffset>0.9</needLevelOffset>
        <overdoseSeverityOffset>0.18~0.35</overdoseSeverityOffset>
        <listOrder>30</listOrder>
      </li>
    </comps>
    <allowedArchonexusCount>20</allowedArchonexusCount>
    <possessionCount>5</possessionCount>
  </ThingDef>

  <HediffDef>
    <defName>PsilocapHigh</defName>
    <label>psilocap hallucinations</label>
    <description>Chemicals from psilocap spores, possibly inhaled from the air, are causing this person to experience subtle hallucinations that distort their perception of reality.</description>
    <hediffClass>Hediff_High</hediffClass>
    <defaultLabelColor>(1,0,0.5)</defaultLabelColor>
    <initialSeverity>0.01</initialSeverity>
    <scenarioCanAdd>true</scenarioCanAdd>
    <maxSeverity>1.0</maxSeverity>
    <isBad>false</isBad>
    <comps>
      <li Class="HediffCompProperties_SeverityPerDay">
        <severityPerDay>-1.92</severityPerDay> <!-- 8% per hour -->
        <showHoursToRecover>true</showHoursToRecover>
      </li>
    </comps>
    <stages>
      <li>
        <label>minor</label>
        <capMods>
          <li>
            <capacity>Consciousness</capacity>
            <postFactor>0.9</postFactor>
          </li>
        </capMods>
      </li>
      <li>
        <minSeverity>0.25</minSeverity>
        <label>moderate</label>
        <capMods>
          <li>
            <capacity>Consciousness</capacity>
            <postFactor>0.7</postFactor>
          </li>
        </capMods>
        <statOffsets>
          <WorkSpeedGlobal>-0.2</WorkSpeedGlobal>
        </statOffsets>
      </li>
      <li>
        <minSeverity>0.85</minSeverity>
        <label>extreme</label>
        <capMods>
          <li>
            <capacity>Consciousness</capacity>
            <setMax>0.35</setMax>
          </li>
        </capMods>
        <statOffsets>
          <WorkSpeedGlobal>-0.5</WorkSpeedGlobal>
        </statOffsets>
      </li>
    </stages>
  </HediffDef>

  <ThoughtDef>
    <defName>PsilocapHigh</defName>
    <workerClass>ThoughtWorker_Hediff</workerClass>
    <hediff>PsilocapHigh</hediff>
    <validWhileDespawned>true</validWhileDespawned>
    <developmentalStageFilter>Baby, Child, Adult</developmentalStageFilter>
    <stages>
      <li>
        <label>psilocap hallucinations</label>
        <description>My emotions feel stronger and warmer.</description>
        <baseMoodEffect>5</baseMoodEffect>
      </li>
      <li>
        <label>psilocap hallucinations</label>
        <description>All my senses seem to blend together. Everything is connected...</description>
        <baseMoodEffect>14</baseMoodEffect>
      </li>
      <li>
        <label>psilocap hallucinations</label>
        <description>My mind is open. I feel everything. I am the universe.</description>
        <baseMoodEffect>24</baseMoodEffect>
      </li>
    </stages>
  </ThoughtDef>

  <!-- Psilocap tolerance -->

  <ChemicalDef>
    <defName>Psilocap</defName>
    <label>psilocap</label>
    <toleranceHediff>PsilocapTolerance</toleranceHediff>
    <generateAddictionGenes>false</generateAddictionGenes>
    <canBeAddicted>false</canBeAddicted>
  </ChemicalDef>

  <HediffDef ParentName="DrugToleranceBase">
    <defName>PsilocapTolerance</defName>
    <label>psilocap tolerance</label>
    <description>An acquired tolerance to psilocap. The more severe this tolerance is, the more psilocap it takes to get the same effect.</description>
    <comps>
      <li Class="HediffCompProperties_SeverityPerDay">
        <severityPerDay>-0.020</severityPerDay>
      </li>
      <li Class="HediffCompProperties_DrugEffectFactor">
        <chemical>Psilocap</chemical>
      </li>
    </comps>
  </HediffDef>
</Defs>
