<?xml version="1.0" encoding="utf-8"?>
<Defs>
  
  <MapGeneratorDef Name="SpaceMapGenerator">
    <defName>Space</defName>
    <label>space</label>
    <ignoreAreaRevealedLetter>true</ignoreAreaRevealedLetter>
    <disableCallAid>true</disableCallAid>
    <renderWorld>true</renderWorld>
    <disableMapClippers>true</disableMapClippers>
    <defaultUnderGridTerrain>Space</defaultUnderGridTerrain>
    <genSteps>
      <li>Space</li>
      <li>ScenParts</li>
      <li>FogSpace</li>
    </genSteps>
  </MapGeneratorDef>
  
  <MapGeneratorDef Name="SpacePocket" ParentName="SpaceMapGenerator">
    <defName>SpacePocket</defName>
    <pocketMapProperties>
      <biome>Orbit</biome>
      <temperature>-75</temperature>
      <canLaunchGravship>true</canLaunchGravship>
    </pocketMapProperties>
  </MapGeneratorDef>
  
  <GenStepDef>
    <defName>Space</defName>
    <order>100</order>
    <genStep Class="GenStep_Space" />
  </GenStepDef>

  <MapGeneratorDef ParentName="SpaceMapGenerator">
    <defName>Asteroid</defName>
    <label>asteroid</label>
    <genSteps>
      <li>Asteroid</li>
      <li>AsteroidBasicTransportPods</li>
      <li>MechShipChunk_Asteroid</li>
      <li>RockChunks</li>
    </genSteps>
  </MapGeneratorDef>

  <MapGeneratorDef ParentName="SpaceMapGenerator">
    <defName>AsteroidBasic</defName>
    <label>basic asteroid</label>
    <genSteps>
      <li>AsteroidBasic</li>
      <li>AsteroidBasicTransportPods</li>
      <li>AncientMiningCharge_Asteroid</li>
      <li>AncientExplosivesCrate_Asteroid</li>
      <li>AncientDrillPlatform_Asteroid</li>
      <li>AncientTuneller_Asteroid</li>
      <li>MechShipChunk_Asteroid</li>
      <li>RockChunks</li>
    </genSteps>
  </MapGeneratorDef>

  <MapGeneratorDef ParentName="SpaceMapGenerator">
    <defName>OrbitalItemStash</defName>
    <label>orbital item stash</label>
    <genSteps>
      <li>Asteroid_NoRuins</li>
      <li>MechShipChunk_Asteroid</li>
      <li>AsteroidItemStash</li>
      <li>RockChunks</li>
    </genSteps>
  </MapGeneratorDef>

  <MapGeneratorDef ParentName="SpaceMapGenerator">
    <defName>SettlementPlatform</defName>
    <label>settlement platform</label>
    <defeatRequiresCantReachUnfogged>false</defeatRequiresCantReachUnfogged>
    <genSteps>
      <li>SettlementPlatform</li>
      <li>SettlementPawnsLoot</li>
    </genSteps>
  </MapGeneratorDef>

  <GenStepDef>
    <defName>SettlementPlatform</defName>
    <order>200</order>
    <genStep Class="GenStep_OrbitalPlatform">
      <platformTerrain>OrbitalPlatform</platformTerrain>
      <useSiteFaction>true</useSiteFaction>
      <layoutDef>OrbitalSettlementPlatform</layoutDef>
      <cannonDef>GaussCannon</cannonDef>
      <temperature>20</temperature>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>SettlementPawnsLoot</defName>
    <order>700</order>
    <genStep Class="GenStep_SettlementPawnsLoot">
      <requiresRoof>true</requiresRoof>
    </genStep>
  </GenStepDef>
  
  <MapGeneratorDef ParentName="SpaceMapGenerator">
    <defName>OrbitalRelay</defName>
    <label>orbital relay</label>
    <genSteps>
      <li>OrbitalRelay</li>
      <li>OrbitalRelay_JunkClusters</li>
    </genSteps>
    <validScenarioMap>true</validScenarioMap>
  </MapGeneratorDef>

  <GenStepDef>
    <order>900</order>
    <defName>OrbitalRelay_JunkClusters</defName>
    <genStep Class="GenStep_ScatterGroup">
      <minSpacing>5</minSpacing>
      <isJunk>true</isJunk>
      <countPer10kCellsRange>0.5~1</countPer10kCellsRange>
      <spotMustBeStandable>true</spotMustBeStandable>
      <allowRoofed>false</allowRoofed>
      <validators>
        <li Class="ScattererValidator_TerrainDef">
          <terrainDef>MechanoidPlatform</terrainDef>
        </li>
      </validators>
      <groups>
        <li>
          <things>
            <ChunkMechanoidSlag>1</ChunkMechanoidSlag>
          </things>
          <coveredCellsPer10Cells>1~2</coveredCellsPer10Cells>
          <filthDef>Filth_MachineBits</filthDef>
          <filthExpandBy>1</filthExpandBy>
          <filthChance>0.05</filthChance>
          <clusterRectRadius>1~3</clusterRectRadius>
        </li>
      </groups>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>Asteroid</defName>
    <order>200</order>
    <genStep Class="GenStep_Asteroid">
      <numChunks>5~8</numChunks>
      <ruinsChance>0.5</ruinsChance>
      <archeanTreeChance>0.25</archeanTreeChance>
      <mineableCounts>
        <MineableGold>33~42</MineableGold>
        <MineablePlasteel>35~48</MineablePlasteel>
        <MineableUranium>52~72</MineableUranium>
      </mineableCounts>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>Asteroid_NoRuins</defName>
    <order>200</order>
    <genStep Class="GenStep_Asteroid">
      <numChunks>4~6</numChunks>
      <ruinsChance>0</ruinsChance>
      <archeanTreeChance>0.25</archeanTreeChance>
      <mineableCounts>
        <MineableGold>14~22</MineableGold>
        <MineableSilver>50~70</MineableSilver>
        <MineableSteel>80~110</MineableSteel>
        <MineableUranium>15~25</MineableUranium>
        <MineablePlasteel>12~15</MineablePlasteel>
        <MineableComponentsIndustrial>65~85</MineableComponentsIndustrial>
        <MineableJade>20~35</MineableJade>
      </mineableCounts>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>AsteroidBasic</defName>
    <order>200</order>
    <genStep Class="GenStep_BasicAsteroid">
      <numChunks>4~6</numChunks>
      <ruinsChance>0.1</ruinsChance>
      <archeanTreeChance>0.25</archeanTreeChance>
      <mineableCounts>
        <MineableGold>14~22</MineableGold>
        <MineableSilver>50~70</MineableSilver>
        <MineableSteel>80~110</MineableSteel>
        <MineableUranium>15~25</MineableUranium>
        <MineablePlasteel>12~15</MineablePlasteel>
        <MineableComponentsIndustrial>65~85</MineableComponentsIndustrial>
        <MineableJade>20~35</MineableJade>
      </mineableCounts>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>AsteroidBasicTransportPods</defName>
    <order>210</order>
    <genStep Class="GenStep_ScatterThings">
      <minSpacing>50</minSpacing>
      <countPer10kCellsRange>0.2~0.5</countPer10kCellsRange>
      <validators>
        <li Class="ScattererValidator_TerrainDef">
          <radius>1</radius>
          <terrainDef>Vacstone_Rough</terrainDef>
        </li>
        <li Class="ScattererValidator_Roof">
          <radius>1</radius>
          <roofDef IsNull="True"/> <!-- No roof -->
        </li>
      </validators>
      <thingDef>AncientTransportPod</thingDef>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>AsteroidItemStash</defName>
    <order>500</order>
    <genStep Class="GenStep_AsteroidItemStash"/>
  </GenStepDef>

  <GenStepDef>
    <defName>OrbitalRelay</defName>
    <order>200</order>
    <genStep Class="GenStep_OrbitalRelay">
      <orbitalDebrisDef>Mechanoid</orbitalDebrisDef>
      <satelliteRange>3~5</satelliteRange>
      <scatterRange>2~3</scatterRange>
      <centerPrefabs>
        <OrbitalRelay_Center_1 />
      </centerPrefabs>
      <satellitePrefabs>
        <OrbitalRelay_Satellite_1>
          <minMaxRange>1~2</minMaxRange>
        </OrbitalRelay_Satellite_1>
        <OrbitalRelay_Satellite_2>
          <minMaxRange>1~1</minMaxRange>
        </OrbitalRelay_Satellite_2>
        <OrbitalRelay_Satellite_3>
          <minMaxRange>1~1</minMaxRange>
        </OrbitalRelay_Satellite_3>
      </satellitePrefabs>
      <scatterPrefabs>
        <OrbitalRelay_Scatter_1 />
        <OrbitalRelay_Scatter_2 />
        <OrbitalRelay_Scatter_3>0.5</OrbitalRelay_Scatter_3>
      </scatterPrefabs>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>FogSpace</defName>
    <order>1500</order>
    <genStep Class="GenStep_FogSpace" />
  </GenStepDef>

  <GenStepDef>
    <order>900</order>
    <defName>AncientMiningCharge_Asteroid</defName>
    <genStep Class="GenStep_ScatterThings">
      <thingDef>AncientMiningCharge</thingDef>
      <countPer10kCellsRange>0~3</countPer10kCellsRange>
      <minSpacing>5</minSpacing>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <order>900</order>
    <defName>AncientExplosivesCrate_Asteroid</defName>
    <genStep Class="GenStep_ScatterThings">
      <thingDef>AncientExplosivesCrate</thingDef>
      <countPer10kCellsRange>0~0.25</countPer10kCellsRange>
      <minSpacing>5</minSpacing>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <order>900</order>
    <defName>AncientDrillPlatform_Asteroid</defName>
    <genStep Class="GenStep_ScatterThings">
      <thingDef>AncientDrillPlatform</thingDef>
      <countPer10kCellsRange>0~0.25</countPer10kCellsRange>
      <minSpacing>5</minSpacing>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <order>910</order>
    <defName>MechShipChunk_Asteroid</defName>
    <genStep Class="GenStep_ScatterGroup">
      <countPer10kCellsRange>0.0~0.25</countPer10kCellsRange>
      <groups>
        <li>
          <things>
            <GravlitePanel>0.2</GravlitePanel>
          </things>
          <stackSizeRange>5~10</stackSizeRange>
          <spawnForbidden>true</spawnForbidden>
          <indoorRuin>false</indoorRuin>
          <coveredCellsPer10Cells>0~1</coveredCellsPer10Cells>
          <filthDef>Filth_MachineBits</filthDef>
          <filthExpandBy>1</filthExpandBy>
          <filthChance>0.4</filthChance>
          <clusterRectRadius>2</clusterRectRadius>
          <spawnAtCenter>ShipChunk_Mech</spawnAtCenter>
        </li>
      </groups>
      <validators>
        <li Class="ScattererValidator_TerrainDef">
          <radius>1</radius>
          <terrainDef>Vacstone_Rough</terrainDef>
        </li>
      </validators>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <order>910</order>
    <defName>AncientTuneller_Asteroid</defName>
    <genStep Class="GenStep_ScatterGroup">
      <countPer10kCellsRange>0.1</countPer10kCellsRange>
      <isJunk>true</isJunk>
      <groups>
        <li>
          <things>
            <AncientTunnelerClaw>0.4</AncientTunnelerClaw>
            <AncientTunnelerClaw>0.2</AncientTunnelerClaw>
            <ChunkMechanoidSlag>0.8</ChunkMechanoidSlag>
          </things>
          <indoorRuin>false</indoorRuin>
          <coveredCellsPer10Cells>1.5~2.5</coveredCellsPer10Cells>
          <filthDef>Filth_MachineBits</filthDef>
          <filthExpandBy>1</filthExpandBy>
          <filthChance>0.4</filthChance>
          <clusterRectRadius>3~5</clusterRectRadius>
        </li>
      </groups>
    </genStep>
  </GenStepDef>
  
</Defs>